function Seq_object(){this.item=Seq_item,this.JS_timer_used=[],this.JS_timer_active=[],this.setInterval=Seq_setInterval,this.clearInterval=Seq_clearInterval,this.clearTimeout=Seq_clearInterval}function Seq_item(e){return seq_items[e]||(seq_items[e]=new Seq_core(e)),seq_items[e]}function Seq_core(e){this.name=e,this.count=0,this.At=Seq_at,this.Play=this.play=Seq_play,this.Pause=this.pause=Seq_pause,this.Stop=Seq_stop,this.exec=Seq_exec}function Seq_at(init_delay,func,max_count,interval){this.initialized=!0,this.init_delay=parseInt(1e3*init_delay)+1,"string"==typeof func?eval("this.func = function () {"+func+(/^\s*\w+$/.test(func)?"()":"")+"}"):this.func=func,this.max_count=max_count,this.interval=this.interval_current=parseInt(1e3*interval),this.update_time_last=0}function Seq_play(){if(this.initialized)if(this.paused=!1,this.count){if(this.timerID)return;seq_items[this.name].exec()}else{this.timerID&&clearTimeout(this.timerID);var e=this.name;this.timerID=setTimeout(function(){seq_items[e].exec(),e=null},this.init_delay)}}function Seq_exec(){if(!this.paused)if(this.count++!=this.max_count){var e=Date.now(),t=this.update_time_last,i=this.interval_current;if(this.interval_current=null,this.interval>Seq_interval_current_min&&t>0){var r=e-t-i;r>0&&((i=this.interval-r)<Seq_interval_current_min&&(i=Seq_interval_current_min),this.interval_current=i)}this.update_time_last=e,null==this.interval_current&&(this.interval_current=this.interval);var _=this.name;this.timerID=setTimeout(function(){seq_items[_].exec(),_=null},this.interval_current),this.func()}else this.Stop()}function Seq_stop(){this.Pause(),this.count=0,Seq.onstop&&Seq.onstop(this.name)}function Seq_pause(){this.paused=!0,this.timerID&&(clearTimeout(this.timerID),this.timerID=null)}function Seq_setInterval(e,t){for(var i=-1,r=0;r<this.JS_timer_used.length;r++)if(!this.JS_timer_used[r]){i=r;break}-1==i&&(i=this.JS_timer_used.length);for(var _="T"+Date.now();this.JS_timer_active[_];)_+="-0";this.JS_timer_active[_]=i+1,this.JS_timer_used[i]=!0,t/=1e3;var s=Seq.item("JS-timer"+i);return s.At(t,e,-1,t),s.Play(),DEBUG_show("SI:"+i,2),_}function Seq_clearInterval(e){var t=this.JS_timer_active[e];t&&(t--,this.JS_timer_active[e]=null,this.JS_timer_used[t]=null,Seq.item("JS-timer"+t).Stop(),DEBUG_show("CI:"+t,2))}function Shell_ReturnItemsFromFolder(e,t,i){t||(t={}),t.RE_items||(t.RE_items=/\.(bmp|gif|jpg|jpeg|png)$/i),t.gallery||(t.gallery=[]),i||(t._shell_item_count=0);var r;try{r=System.Shell.itemFromPath(e)}catch(e){}if(!r)return i?null:[];for(var _=r.SHFolder.Items,s=0,n=_.count;s<n;s++){if(++t._shell_item_count>9999){if(i)return null;break}var a=_.item(s);if(a.isLink){var o;try{o=System.Shell.itemFromPath(a.link.path)}catch(e){}if(!o)continue;a=o}if(a.isFolder){if(!Shell_ReturnItemsFromFolder(a.path,t,!0)&&i)return null}else if(a.isFileSystem){var e=a.path;if(!t.RE_items.test(e))continue;var l={index:t.gallery.length,path:e,path_file:toFileProtocol(e)};t.gallery.push(l)}}return t.gallery}function WMI_CreateObject(e){WMI_AL_mode&&(Shell_OBJ||(Shell_OBJ=new ActiveXObject("Shell.Application")),FSO_OBJ||(FSO_OBJ=new ActiveXObject("Scripting.FileSystemObject")),oShell||(oShell=new ActiveXObject("WScript.Shell")),!e||xul_mode||webkit_mode)||WMI_obj||(WMI_obj=self.GetObject?GetObject("winmgmts:"):new ActiveXObject("WbemScripting.SWbemLocator").ConnectServer())}function WMI_Refresher(e,t){this.loaded=!1,this.refresher=null,this.objs=null,this.collection=[],this.WMI_class=e,this.refresher_id=t||null,this.init=WMI_Refresher_init,this.update=WMI_Refresher_update,this.refresh=WMI_Refresher_refresh}function WMI_Refresher_init(){if(!this.loaded){this.loaded=!0,this.refresher_id&&WMI_objs_count++;try{if(WMI_CreateObject(!this.refresher_id),WMI_AL_mode){if(!this.refresher_id)return;if(WMI_perfmon.init(this))return;return WMI_AL_refresher_id[this.WMI_class]=this.refresher_id,void WMI_AL_run_timer()}if(!this.refresher_id)return;var e=WMI_refreshers[this.refresher_id];e||(e={obj:new ActiveXObject("WbemScripting.SWbemRefresher"),WMI_class_objs:{}},WMI_refreshers[this.refresher_id]=e,WMI_refreshers_count++),this.refresher=e;var t=e.WMI_class_objs[this.WMI_class];this.objs=t||(e.WMI_class_objs[this.WMI_class]=e.obj.AddEnum(WMI_obj,this.WMI_class))}catch(e){alert(e.toString())}}}function WMI_Refresher_refresh(){try{if(!this.refresher_id)return;if(WMI_AL_mode)return;var e=this.refresher;if(e.refreshed_count_last==PC_count_absolute)return!0;e.refreshed_count_last=PC_count_absolute,e.obj.Refresh()}catch(e){}}function WMI_Refresher_update(e){var t=[];try{if(this.refresh()&&this.refreshed_count_last==PC_count_absolute)t=this.collection;else{if(WMI_AL_mode&&this.refresher_id){var i=WMI_AL_temp_path+"\\"+WMI_AL_temp_filename+".txt";if(WMI_AL_WSH_result_obj&&this.refreshed_count_last==PC_count_absolute)h=WMI_AL_WSH_result_obj;else try{if(FSO_OBJ.FileExists(i)){c=(n=FSO_OBJ.OpenTextFile(i,1)).ReadLine();WMI_AL_WSH_result_obj=h=JSON.parse(c),n.Close()}}catch(e){WMI_AL_WSH_result_obj=h=null}var r=this.WMI_class;if(h&&h[r])t=h[r];else for(var _=WMI_AL_ref[r],s=0;s<_.collection_length_default;s++)t.push(_.properties);try{if(this.tmp_file_update_count_last||(this.tmp_file_update_count_last=this.refreshed_count_last),this.tmp_file_update_count_last<this.refreshed_count_last-100)if(this.tmp_file_update_count_last=this.refreshed_count_last,xul_mode){var n=FSO_OBJ.OpenTextFile(WMI_AL_temp_path+"\\"+WMI_AL_temp_filename+".tmp",2,!1);n.Write(""),n.Close()}else{var a=new Date;a.getMonth(),a.getDate(),a.getFullYear(),a.getHours(),("00"+a.getMinutes()).slice(-2),("00"+a.getSeconds()).slice(-2),a.getHours();Shell_OBJ.NameSpace(WMI_AL_temp_path).ParseName(WMI_AL_temp_filename+".tmp").ModifyDate=a}}catch(e){}}else{var o,l=!0;if(this.refresher_id)o=this.objs.ObjectSet;else if(xul_mode||webkit_mode){l=!1;var c,h,u=(r=this.WMI_class)+",(),0",m=System.Gadget.path+"\\js\\wmi_al.wsf",f=oShell.ExpandEnvironmentStrings("%TEMP%"),p="TEMP_WMI_one-time_"+Date.now()+("-"+Math.random()).replace(/0\./,"");if(xul_mode){XPCOM_object["Shell.Application"]._run(m,encodeURIComponent(p)+" "+encodeURIComponent(u),!0,SystemEXT.enforce_WSH);try{var d=FileIO.open(f+"\\"+p+".txt");c=FileIO.readText(d),FileIO.unlink(d)}catch(e){DEBUG_show(e.toString())}}else{WebKit_object["Shell.Application"]._run(m,encodeURIComponent(p)+" "+encodeURIComponent(u),null,!0),f+="\\"+p+".txt";try{var g=require("fs");g.existsSync(f)&&(c=g.readFileSync(f),g.unlinkSync(f))}catch(e){DEBUG_show(e.toString())}}if(c&&(h=JSON.parse(c)),h&&h[r])t=h[r];else for(var _=WMI_AL_ref[r],s=0;s<_.collection_length_default;s++)t.push(_.properties)}else o=e?WMI_obj.ExecQuery("SELECT * FROM "+this.WMI_class+" WHERE "+e):WMI_obj.InstancesOf(this.WMI_class);if(l)for(var I=new Enumerator(o);!I.atEnd();I.moveNext())t.push(I.item())}this.refreshed_count_last=PC_count_absolute}}catch(e){}return this.collection=t,t}function WMI_AL_stop(){try{WMI_AL_script_running&&FSO_OBJ.DeleteFile(WMI_AL_temp_path+"\\"+WMI_AL_temp_filename+".tmp")}catch(e){alert(e.toString())}}function WMI_AL_run_timer(){WMI_AL_script_running||(WMI_AL_timerID&&(clearTimeout(WMI_AL_timerID),WMI_AL_timerID=null),WMI_AL_timerID=setTimeout(WMI_AL_run_command,10))}function WMI_AL_run_command(){var paras=[],c;for(c in WMI_AL_refresher_id)c&&!/shuffle/.test(c)&&paras.push(c+","+WMI_AL_refresher_id[c]+","+eval(WMI_AL_ref[c].timer_interval));paras.length&&(WMI_AL_js_path||(WMI_AL_js_path=System.Gadget.path+"\\js\\wmi_al.wsf"),WMI_AL_temp_path||(WMI_AL_temp_path=oShell.ExpandEnvironmentStrings("%TEMP%")),WMI_AL_temp_filename||(WMI_AL_temp_filename=(self.Settings&&Settings.f_path?Settings.f_path.replace(/^.+\\/,"").replace(/\s/g,"_"):"TEMP")+"_"+Date.now()+("-"+Math.random()).replace(/0\./,"")),FSO_OBJ.OpenTextFile(WMI_AL_temp_path+"\\"+WMI_AL_temp_filename+".txt",2,!0).Close(),FSO_OBJ.OpenTextFile(WMI_AL_temp_path+"\\"+WMI_AL_temp_filename+".tmp",2,!0).Close(),WMI_AL_script_running=!0,Shell_OBJ.ShellExecute(WMI_AL_js_path,encodeURIComponent(WMI_AL_temp_filename)+" "+encodeURIComponent(paras.join("|"))),DEBUG_show("Use WMI",2))}function imgCache_Object(e,t,i){self[e]=null,this.img_id=e,this.img_parent_id=t,this.use_native_img=!!i,i&&native_img_objs.push(this),this.path_last="",this.img_cache=[],this.SS_mode=!1,this.img_for_preload=null,this.SS_preload=imgCache_SS_Preload,this.SS_path_list_lvl=0,this.SS_path_list_index=-1,this.SS_path_list=[null,null],this.SS_path=null,this.load=imgCache_Load,this.show=imgCache_Show,this.clear=imgCache_Clear,this.createIMG=imgCache_CreateIMG,this.styleUpdate=imgCache_StyleUpdate}function imgCache_Clear(){self[this.img_id]=null,this.img_cache=[]}function imgCache_StyleObject(){this.posLeft=null,this.posTop=null,this.pixelWidth=null,this.pixelHeight=null}function imgCache_StyleUpdate(){if(this.use_native_img){var e=self[this.img_id],t=e.img,i=e.width,r=e.height,_=t.width,s=t.height,n=e.style;null!=n.pixelWidth&&(t.width=_=n.pixelWidth),null!=n.pixelHeight&&(t.height=s=n.pixelHeight),null!=n.posLeft&&(t.left=n.posLeft+(_-i)/2),null!=n.posTop&&(t.top=n.posTop+(s-r)/2)}}function imgCache_CreateIMG(e){var t;if(this.use_native_img){var i=toLocalPath(e);(t={img:BG.addImageObject(i,0,0),src:e,style:new imgCache_StyleObject}).width=t.img.width,t.height=t.img.height}else(t=document.createElement("img")).style.position="absolute",t.src=e,document.getElementById(this.img_parent_id).appendChild(t);return t.docked=System.Gadget.docked,t}function imgCache_Show(e){var t=self[this.img_id];t&&(this.use_native_img?t.img.opacity=e?100:0:use_gallery_img_cache||this.img_for_preload?t.style.display=e?"block":"none":t.style.visibility=e?"inherit":"hidden")}function imgCache_Load(e){var t,i=!1;return this.use_native_img||use_gallery_img_cache||this.img_for_preload&&this.img_cache[e]?(t=this.img_cache[e],t?t.docked==System.Gadget.docked?i=t.initialized:(t.docked=System.Gadget.docked,i=!1):(t=this.img_cache[e]=this.createIMG(e),i=!1),self[this.img_id]&&this.show(!1),this.img_for_preload&&(this.img_for_preload=self[this.img_id],this.img_cache=[]),self[this.img_id]=t,this.show(!0),i):(t=self[this.img_id],t?(this.path_last==e?i=!0:(t.src=e,this.path_last=e),t.style.visibility="inherit"):self[this.img_id]=this.createIMG(e),i)}function imgCache_SS_Preload(){var e=this.SS_path_list[this.SS_path_list_lvl][++this.SS_path_list_index];if(++this.SS_path_list_index>=this.SS_path_list[this.SS_path_list_lvl].length&&(this.SS_path_list_index=-1,0==this.SS_path_list_lvl)){var t=SEQ_gallery_all[SEQ_gallery_index];t.count+1>=t.loop&&(this.SS_path_list_lvl=1)}var i=this.img_cache[e];i?i.initialized=!1:(!use_gallery_img_cache&&this.img_for_preload?(this.img_for_preload.src=e,i=this.img_cache[e]=this.img_for_preload):(i=this.img_cache[e]=this.createIMG(e),use_gallery_img_cache||(this.img_for_preload=i)),i.style.visibility="inherit",i.style.display="none",i.initialized=!1)}Date.now||(Date.now=function(){return(new Date).getTime()});var seq_items=[],Seq_interval_current_min=10,Seq,SeqOBJ;Seq=SeqOBJ=new Seq_object;var WMI_obj,WMI_objs_count=0,WMI_refreshers=[],WMI_refreshers_count=0,PC_count_absolute=0,xul_mode,webkit_mode,WMI_AL_mode;(xul_mode||webkit_mode)&&(WMI_AL_mode=!0);var WMI_AL_timerID,WMI_AL_js_path,WMI_AL_temp_path,WMI_AL_temp_filename,WMI_AL_WSH_result_obj,WMI_AL_refresher_id=[],Shell_OBJ,FSO_OBJ,oShell,WMI_AL_script_running,WMI_perfmon;WMI_perfmon=is_SA_child_animation?parent.WMI_perfmon:{perfmon:null,counter:{},counter_list:[],loaded:!1,init:function(e){if(!webkit_electron_mode)return!1;if(!windows_mode)return!0;switch(this.loaded||(this.loaded=!0,this.perfmon=SA_require("perfmon")),e.WMI_class){case"Win32_PerfFormattedData_PerfDisk_LogicalDisk":e.update=WMI_perfmon.update_func("LogicalDisk"),WMI_perfmon.LogicalDisk_counter_list||WMI_perfmon.perfmon.list("LogicalDisk",function(e,t){WMI_perfmon.LogicalDisk_init(e,t)});break;case"Win32_PerfFormattedData_Tcpip_NetworkInterface":e.update=WMI_perfmon.update_func("Network Interface"),WMI_perfmon.NetworkInterface_counter_list||WMI_perfmon.perfmon.list("Network Interface",function(e,t){WMI_perfmon.NetworkInterface_init(e,t)});break;case"Win32_PerfFormattedData_PerfOS_Memory":e.update=WMI_perfmon.update_func("Memory"),WMI_perfmon.run(["Memory\\Pages Input/sec","Memory\\Pages Output/sec"]);break;default:return!1}return!0},update_func:function(e){return function(){return this.collection=WMI_perfmon.counter_result[e],this.collection}},run_timerID:null,run:function(e){this.run_timerID&&clearTimeout(this.run_timerID),e.forEach(function(e){WMI_perfmon.counter[e]=!0});for(var t in this.counter)this.counter_list.push(t);this.run_timerID=setTimeout(function(){WMI_perfmon.run_timerID=null,WMI_perfmon.counter_start()},1e3)},counter_result:{LogicalDisk:[],"Network Interface":[],Memory:[]},counter_start:function(){DEBUG_show("Use Perfmon",2),this.perfmon(this.counter_list,function(e,t){WMI_perfmon.counter_process(e,t)})},counter_process:function(e,t){if(!e){this.counter_result.LogicalDisk=[],this.counter_result["Network Interface"]=[],this.counter_result.Memory=[];var i={};for(var r in t.counters){var _=t.counters[r];if(/LogicalDisk\(([^\)]+)\)/.test(r))this.counter_result.LogicalDisk.push({Name:RegExp.$1,PercentDiskTime:_});else if(/Network Interface\(([^\)]+)\)/.test(r)){var s=i[a=RegExp.$1];s||(s=i[a]={}),/Bytes Received\/sec/.test(r)?s.BytesReceivedPerSec=_:/Bytes Sent\/sec/.test(r)&&(s.BytesSentPerSec=_)}else if(/Memory/.test(r)){var n=this.counter_result.Memory;n[0]||(n=this.counter_result.Memory=[{}]),"Memory\\Pages Input/sec"==r?n[0].PagesInputPerSec=_:"Memory\\Pages Output/sec"==r&&(n[0].PagesOutputPerSec=_)}}for(var a in i)this.counter_result["Network Interface"].push(i[a])}},LogicalDisk_drive_list:null,LogicalDisk_counter_list:null,LogicalDisk_init:function(e,t){e?DEBUG_show(e.message):(this.LogicalDisk_drive_list=[],this.LogicalDisk_counter_list=[],t.counters.forEach(function(e){if(/LogicalDisk\(([^\)]+)\)\\\% Disk Time/.test(e)){var t=RegExp.$1;"_Total"==t?WMI_perfmon.LogicalDisk_counter_list.push(e):/^\w\:$/.test(t)&&(WMI_perfmon.LogicalDisk_drive_list.push(t),WMI_perfmon.LogicalDisk_counter_list.push(e))}}),this.run(this.LogicalDisk_counter_list))},NetworkInterface_counter_list:null,NetworkInterface_init:function(e,t){e?DEBUG_show(e.message):(this.NetworkInterface_counter_list=[],t.counters.forEach(function(e){/Network Interface\(([^\)]+)\)\\Bytes (Received|Sent)\/sec/.test(e)&&WMI_perfmon.NetworkInterface_counter_list.push(e)}),this.run(this.NetworkInterface_counter_list))}},WMI_AL_mode&&document.write('<script type="text/javascript" language="javascript" src="js/wmi_al_core.js"><\/script>\n');var xul_mode,webkit_mode,DragDrop={init:function(e,t,i){xul_mode?(e.addEventListener("dragover",XPCOM_object._dragOver,!0),e.addEventListener("drop",XPCOM_object._dragDrop,!0)):webkit_mode?(e.addEventListener("dragenter",WebKit_object._dragEnter,!1),e.addEventListener("dragexit",WebKit_object._dragExit,!1),e.addEventListener("dragover",WebKit_object._dragOver,!1),e.addEventListener("drop",WebKit_object._drop,!1)):(e.ondragenter=function(e){DragDrop.onDragEnter(e)},e.ondragover=function(e){DragDrop.onDragOver(e)},e.ondrop=function(e){DragDrop.onDrop(e)}),this.onDrop_finish=t,this.validate_func=i||function(e){return e.isFolder},ie9_mode&&(this._ondrop_finish=t,this._ondrop_finish_process=function(e,t){DragDrop.drop_target(e.isFolder)._ondrop_finish(e,t)},Object.defineProperty(this,"onDrop_finish",{get:function(){return this._ondrop_finish_process},set:function(e){this._ondrop_finish=e}}),this._validate_func=this.validate_func,this._validate_func_process=function(e,t){return DragDrop.drop_target(e.isFolder)._validate_func(e,t)},Object.defineProperty(this,"validate_func",{get:function(){return this._validate_func_process},set:function(e){this._validate_func=e}}),this.drop_target=function(e){var t;if(!e&&!this._no_relay){var i=self.is_SA_child_animation?parent:self,r=i.DragDrop.relay_id;null!=r&&i.SA_child_animation[r]&&(t=i.document.getElementById("Ichild_animation"+r).contentWindow.DragDrop)}return t||(t=self.is_SA_child_animation&&null!=self.ChildMirror_id&&parent.SA_child_animation[ChildMirror_id]?parent.document.getElementById("Ichild_animation"+ChildMirror_id).contentWindow.DragDrop:this),t})},validateDropItem:function(e){try{var t=System.Shell.itemFromFileDrop(e,0);return this.validate_func(t)}catch(e){return!1}},_dragAccepted:!1,onDragEnter:function(e){event.returnValue=!1,this.validateDropItem(event.dataTransfer)?(event.dataTransfer.dropEffect="link",this._dragAccepted=!0):(event.dataTransfer.dropEffect="none",this._dragAccepted=!1)},onDragOver:function(e){this._dragAccepted&&(event.returnValue=!1,event.dataTransfer.dropEffect="link")},onDrop:function(e){event.returnValue=!1;var t=System.Shell.itemFromFileDrop(event.dataTransfer,0);null!=t&&this.onDrop_finish(t)}},use_gallery_img_cache,use_native_img,native_img_objs=[];